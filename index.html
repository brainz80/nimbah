<!DOCTYPE html>
<html>
<head>
    <title>Nimbah</title>
    <script type='text/javascript' src='lib/knockout-2.2.0.debug.js'></script>
    <script type='text/javascript' src='lib/jquery-1.8.3.min.js'></script>
    <script type='text/javascript' src='lib/jquery-ui-1.9.2.custom.js'></script>
    <script type='text/javascript' src='bindings.js'></script>
    <script type='text/javascript' src='main.js'></script>
    <link rel="stylesheet" type="text/css" href="style.css">

    <script type="text/html" id="pipelineTemplate">
        <div class="pipeline">
            <!-- ko foreach: operators -->
            <div class="pipe" data-bind="drop: dropped"><img src="img/pipe.png" alt="Pipe"></div>
            <div class="operator" data-bind="hovering: hovering, fadeVisible: present, after: function() { presentChanged($parent) }, css: { selected: selected }, click: select">
                <div class="operatorTitle" data-bind="drag: save, css: { hovering: hovering }">
                    <span data-bind="text: name() + '[' + depth() + ']'"></span>
                    <span class="deleteButton" data-bind="fadeVisible: deepestHover, click: function() { present(false); }"></span>
                </div>
                <div class="content" data-bind="template: { name: function(ctx) { return ctx.name() + 'Template'; } }"></div>
            </div>
            <!-- /ko -->
            <div class="pipe" data-bind="drop: dropped"><img src="img/pipe.png" alt="Pipe"></div>
        </div>
    </script>

    <script type="text/html" id="sequenceTemplate">
        <table class="sequence">
            <tr>
                <!-- ko foreach: items -->
                <td class="comma" data-bind="drop: sequenceDropped"><img src="img/comma.png" alt="Comma"></td>
                <td class="sequenceItem" data-bind="hovering: hovering, fadeVisible: present, after: function() { presentChanged($parent) }, css: { selected: selected }, click: select">
                    <div class="deleteButton" data-bind="fadeVisible: deepestHover, click: function() { present(false); }"></div>
                    <div data-bind="template: { name: 'pipelineTemplate' }"></div>
                </td>
                <!-- /ko -->
                <td class="comma" data-bind="drop: sequenceDropped"><img src="img/comma.png" alt="Comma"></td>
            </tr>
        </table>
    </script>

    <script type="text/html" id="settingsTemplate">
        <table data-bind="foreach: settings">
            <tr>
                <td data-bind="text: name"></td>
                <td><input type="text" data-bind="value: value, valueUpdate: 'afterkeydown', style: { width: size + 'px' }, css: { invalidSetting: hasError }, attr: { title: errorMessage }"></td>
            </tr>
        </table>
    </script>

    <script type="text/html" id="splitTemplate">
        <!-- ko template: { name: 'settingsTemplate' } --> <!-- /ko -->
    </script>

    <script type="text/html" id="joinTemplate">
        <!-- ko template: { name: 'settingsTemplate' } --> <!-- /ko -->
    </script>

    <script type="text/html" id="stringTemplate">
        <!-- ko template: { name: 'settingsTemplate' } --> <!-- /ko -->
    </script>

    <script type="text/html" id="pickTemplate">
        <!-- ko template: { name: 'settingsTemplate' } --> <!-- /ko -->
    </script>

    <script type="text/html" id="mapTemplate">
        <div class="dataNavigator">
            <button data-bind="click: previous, enable: hasPrevious">&lt;</button>
            <span data-bind="text: displayPosition"></span> of <span data-bind="text: length"></span>
            <button data-bind="click: next, enable: hasNext">&gt;</button>
        </div>
        <div class="withEachItem">
            <!-- ko template: { name: 'pipelineTemplate', data: withEachItem } --> <!-- /ko -->
        </div>
    </script>

</head>
<body>
    <div class="inputText">
        <!-- ko if: !selected() -->
        <div class="watermark">Enter your input text here...</div>
        <div class="textArea"><textarea data-bind="value: inputText, valueUpdate: 'afterkeydown', hasfocus: inputFocused, style: { opacity: inputOpacity }"></textarea></div>
        <!-- /ko -->
        <!-- ko if: selected -->
        <div class="selectionData" data-bind="text: selected().latestInput()"></div>
        <!-- /ko -->
    </div>
    <div class="outputText">
        <!-- ko if: !selected() -->
        <div class="watermark">Output text will appear here...</div>
        <div class="textArea"><textarea readonly="true" data-bind="value: outputText, hasfocus: outputFocused, style: { opacity: outputOpacity }"></textarea></div>
        <!-- /ko -->
        <!-- ko if: selected -->
        <div class="selectionData" data-bind="text: selected().latestOutput()"></div>
        <!-- /ko -->
    </div>
    <div class="tree" data-bind="template: { name: 'pipelineTemplate', data: pipeline }, click: function() { selected(null); }"></div>
    <div class="palette" data-bind="foreach: operators">
        <div class="paletteItem" data-bind="text: name, drag: create"></div>
    </div>
</body>
</html>
